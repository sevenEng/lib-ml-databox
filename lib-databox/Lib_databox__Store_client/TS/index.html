<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>TS (lib-databox.Lib_databox__Store_client.TS)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="generator" content="doc-ock-html v1.0.0-1-g1fc9bf0"/></head><body><nav id="top"><a href="../index.html">Up</a> &mdash; <span class="package">package <a href="../../index.html">lib-databox</a></span></nav><header><h1><span class="keyword">Module</span> <span class="module-path">Lib_databox__Store_client.TS</span></h1></header><div class="doc"><p>A timeseries store implementation which fulfills <a href="../module-type-TS_SIG/index.html">TS_SIG</a></p></div><div class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>t</code><code></code><code></code></div><div class="doc"></div></div><div class="spec val" id="val-create"><a href="#val-create" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>create : endpoint:string <span class="keyword">&#8209;&gt;</span> <a href="../../Lib_databox/Utils/index.html#type-databox_ctx">Lib_databox.Utils.databox_ctx</a> <span class="keyword">&#8209;&gt;</span> ?&#8288;logging:bool <span class="keyword">&#8209;&gt;</span> unit <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-t">t</a></code></div><div class="doc"><p><code class="code">create store_uri ctx ?logging ()</code> creates a timeseries store instance.
<code class="code">store_uri</code> could be read from <span class="xref-unresolved" title="unresolved reference to &quot;Utils.store_endpoint&quot;">Utils.store_endpoint</span>, <code class="code">ctx</code> could be returned
from <span class="xref-unresolved" title="unresolved reference to &quot;Utils.databox_init&quot;">Utils.databox_init</span>, <code class="code">logging</code> defaults to <code class="code">false</code>.</p></div></div><div class="spec val" id="val-register_datasource"><a href="#val-register_datasource" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>register_datasource : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> meta:<a href="../../Lib_databox/Store_datasource/index.html#type-meta">Lib_databox.Store_datasource.meta</a> <span class="keyword">&#8209;&gt;</span> unit Lwt.t</code></div><div class="doc"></div></div><div class="spec val" id="val-get_datasource_catalogue"><a href="#val-get_datasource_catalogue" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>get_datasource_catalogue : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> string Lwt.t</code></div><div class="doc"></div></div><h2 id="store" class="anchored"><a href="#store" class="anchor"></a>Data store functions</h2><div class="spec val" id="val-write"><a href="#val-write" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>write : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> datasource_id:string <span class="keyword">&#8209;&gt;</span> payload:Ezjsonm.t <span class="keyword">&#8209;&gt;</span> unit Lwt.t</code></div><div class="doc"></div></div><div class="spec val" id="val-write_at"><a href="#val-write_at" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>write_at : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> datasource_id:string <span class="keyword">&#8209;&gt;</span> ts:int64 <span class="keyword">&#8209;&gt;</span> payload:Ezjsonm.t <span class="keyword">&#8209;&gt;</span> unit Lwt.t</code></div><div class="doc"></div></div><h2>Data load functions</h2><p>
All data loaded will be attached with a timestamp, for example:
</p><pre>{ timestamp: 1516633601325,
  data: [
    {temperature: 10.7, long:-0.127758, lat:51.507351, loc: &quot;London&quot; },
    {temperature: -4.1, long:116.407396 lat:39.904200, loc: &quot;Beijing&quot;},
    {temperature: 5.6, long:-122.332071 lat:47.606209, loc: &quot;Seattle&quot;},
  ]
}</pre><p>
Data from <code class="code">data</code> field above is whatever data written into the store by <a href="index.html#store">the write functions</a>.
For functions <a href="index.html#val-last_n">last_n</a>, <a href="index.html#val-first_n">first_n</a>, <a href="index.html#val-since">since</a>, <a href="index.html#val-range">range</a>, the returned result
will be an array of elements of such format.</p><div class="spec val" id="val-latest"><a href="#val-latest" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>latest : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> datasource_id:string <span class="keyword">&#8209;&gt;</span> Ezjsonm.t Lwt.t</code></div><div class="doc"></div></div><div class="spec val" id="val-earliest"><a href="#val-earliest" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>earliest : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> datasource_id:string <span class="keyword">&#8209;&gt;</span> Ezjsonm.t Lwt.t</code></div><div class="doc"></div></div><div class="spec val" id="val-last_n"><a href="#val-last_n" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>last_n : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> datasource_id:string <span class="keyword">&#8209;&gt;</span> int <span class="keyword">&#8209;&gt;</span> Ezjsonm.t Lwt.t</code></div><div class="doc"></div></div><div class="spec val" id="val-first_n"><a href="#val-first_n" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>first_n : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> datasource_id:string <span class="keyword">&#8209;&gt;</span> int <span class="keyword">&#8209;&gt;</span> Ezjsonm.t Lwt.t</code></div><div class="doc"></div></div><div class="spec val" id="val-since"><a href="#val-since" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>since : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> datasource_id:string <span class="keyword">&#8209;&gt;</span> since_ts:int64 <span class="keyword">&#8209;&gt;</span> Ezjsonm.t Lwt.t</code></div><div class="doc"></div></div><div class="spec val" id="val-range"><a href="#val-range" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>range : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> datasource_id:string <span class="keyword">&#8209;&gt;</span> from_ts:int64 <span class="keyword">&#8209;&gt;</span> to_ts:int64 <span class="keyword">&#8209;&gt;</span> Ezjsonm.t Lwt.t</code></div><div class="doc"><p><code class="code">range t ~datasource_id ~from_ts ~to_ts</code>, the <code class="code">from_ts</code> and <code class="code">to_ts</code> are both inclusive
when the store loads the data</p></div></div><div class="spec val" id="val-observe"><a href="#val-observe" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>observe : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> datasource_id:string <span class="keyword">&#8209;&gt;</span> ?&#8288;timeout:int <span class="keyword">&#8209;&gt;</span> unit <span class="keyword">&#8209;&gt;</span> Ezjsonm.t Lwt_stream.t Lwt.t</code></div><div class="doc"></div></div><div class="spec val" id="val-stop_observing"><a href="#val-stop_observing" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>stop_observing : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> datasource_id:string <span class="keyword">&#8209;&gt;</span> unit Lwt.t</code></div><div class="doc"></div></div></body></html>